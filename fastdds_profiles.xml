<?xml version="1.0" encoding="UTF-8" ?>
<profiles xmlns="http://www.eprosima.com/XMLSchemas/fastRTPS_Profiles">
    
    <!-- Default DomainParticipant profile for Cardinal application -->
    <participant profile_name="cardinal_participant" is_default_profile="true">
        <rtps>
            <name>CardinalParticipant</name>
            <defaultUnicastLocatorList>
                <locator>
                    <udpv4>
                        <address>0.0.0.0</address>
                        <port>7400</port>
                    </udpv4>
                </locator>
            </defaultUnicastLocatorList>
            <defaultMulticastLocatorList>
                <locator>
                    <udpv4>
                        <address>239.255.0.1</address>
                        <port>7400</port>
                    </udpv4>
                </locator>
            </defaultMulticastLocatorList>
            
            <!-- Builtin transports configuration -->
            <useBuiltinTransports>true</useBuiltinTransports>
            
            <!-- Discovery configuration -->
            <builtin>
                <discovery_config>
                    <discoveryProtocol>SIMPLE</discoveryProtocol>
                    <use_SIMPLE_EndpointDiscoveryProtocol>true</use_SIMPLE_EndpointDiscoveryProtocol>
                    <use_SIMPLE_ParticipantDiscoveryProtocol>true</use_SIMPLE_ParticipantDiscoveryProtocol>
                    
                    <!-- Lease duration and announcement periods -->
                    <leaseDuration>
                        <sec>20</sec>
                        <nanosec>0</nanosec>
                    </leaseDuration>
                    <announceThreadPeriod>
                        <sec>5</sec>
                        <nanosec>0</nanosec>
                    </announceThreadPeriod>
                </discovery_config>
                
                <!-- Avoid port conflicts in Docker -->
                <avoid_builtin_multicast>false</avoid_builtin_multicast>
            </builtin>
            
            <!-- Resource limits for Docker environment -->
            <allocation>
                <participants>
                    <initial>1</initial>
                    <maximum>10</maximum>
                    <increment>1</increment>
                </participants>
                <readers>
                    <initial>5</initial>
                    <maximum>20</maximum>
                    <increment>5</increment>
                </readers>
                <writers>
                    <initial>5</initial>
                    <maximum>20</maximum>
                    <increment>5</increment>
                </writers>
            </allocation>
        </rtps>
    </participant>
    
    <!-- Publisher profile for Hello World messages -->
    <publisher profile_name="hello_publisher">
        <topic>
            <name>HelloWorldTopic</name>
            <dataType>HelloWorldMsg</dataType>
            <historyQos>
                <kind>KEEP_LAST</kind>
                <depth>10</depth>
            </historyQos>
            <resourceLimitsQos>
                <max_samples>20</max_samples>
                <max_instances>1</max_instances>
                <max_samples_per_instance>20</max_samples_per_instance>
            </resourceLimitsQos>
        </topic>
        <qos>
            <reliability>
                <kind>RELIABLE</kind>
            </reliability>
            <durability>
                <kind>VOLATILE</kind>
            </durability>
        </qos>
        <times>
            <heartbeatPeriod>
                <sec>0</sec>
                <nanosec>500000000</nanosec>
            </heartbeatPeriod>
        </times>
    </publisher>
    
    <!-- Subscriber profile for Hello World messages -->
    <subscriber profile_name="hello_subscriber">
        <topic>
            <name>HelloWorldTopic</name>
            <dataType>HelloWorldMsg</dataType>
            <historyQos>
                <kind>KEEP_LAST</kind>
                <depth>10</depth>
            </historyQos>
            <resourceLimitsQos>
                <max_samples>20</max_samples>
                <max_instances>1</max_instances>
                <max_samples_per_instance>20</max_samples_per_instance>
            </resourceLimitsQos>
        </topic>
        <qos>
            <reliability>
                <kind>RELIABLE</kind>
            </reliability>
            <durability>
                <kind>VOLATILE</kind>
            </durability>
        </qos>
    </subscriber>
    
    <!-- Transport descriptor for UDP -->
    <transport_descriptors>
        <transport_descriptor>
            <transport_id>udp_transport</transport_id>
            <type>UDPv4</type>
            <sendBufferSize>65536</sendBufferSize>
            <receiveBufferSize>65536</receiveBufferSize>
            <TTL>1</TTL>
        </transport_descriptor>
    </transport_descriptors>
    
</profiles> 